---
title: 'Cognitive Aspects of Software Development: a SMS'
output:
  html_document: 
    df_print: tibble
    fig_caption: yes
editor_options: 
  chunk_output_type: inline
---

```{r}
# Keep things nice and tidy, all libraries go here
library(readxl)
library(tidyverse)
library(knitr)
library(kableExtra)
```
```{r}
data <- read_excel("data.xlsx", skip = 1)
data <- data %>% filter(is.na(Exclude))
```

# Visualizing number of publications over time
```{r}
ggplot(data, aes(x=as.factor(Year))) + 
  geom_bar() +  
  ylab("Number of publications") +
  xlab("Year") + 
  geom_text(stat='count', aes(label=..count..), vjust=2, color="white", size = 2.5) + 
  theme_bw() + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 
```


```{r}

# Cleaning not needed values 
data<-data %>% 
    mutate(Academia = replace(Academia, Academia == "?", NA)) %>%
    mutate(Industry = replace(Industry, Industry == "?", NA))

data<-data %>%
  mutate(Type = case_when(is.na(Academia) & is.na(Industry) ~ "None", 
                       Academia == "1.0" & is.na(Industry) ~ "Academia",
                       Industry == "1.0" & is.na(Academia) ~ "Industry", 
                       TRUE ~ "Both"))
```

# Number of publications according to their type
```{r}
data %>% 
  mutate(Type = fct_infreq(Type, ordered = T)) %>% 
ggplot(aes(x=Type)) + 
  geom_bar(width = .5) +
  xlab("Type of publication") + 
  ylab("Number of publications") + 
  geom_text(stat='count', aes(label=..count..), vjust=3, color="white", size = 4) +
  theme_bw()
```

# Number of publications categorized according to SWEBoK Areas. 
A publication can be in more than one category at the same time.

```{r}
data %>% 
  select(7:21) %>% # selecting columns corresponding to the SWEBoK Areas
  mutate_all(replace_na,0) %>% 
  summarise_all(sum) %>% 
  gather(key = "SWEBOKArea", value = "publications", 1:15) %>% 
  arrange(-publications) %>%  
  mutate(SWEBOKArea = factor(SWEBOKArea, SWEBOKArea)) %>% 
  ggplot(aes(x=SWEBOKArea, y=publications)) + 
  geom_bar(stat="identity") + 
  geom_text(aes(label=publications), vjust=-0.3, color="black", size = 4) + 
  xlab("SWEBoK Area") + 
  ylab("Number of publications") +
  theme_bw()
```

# Co-occurrences of SWEBoK Areas
```{r}
data %>% 
  select(7:21) %>% # selecting columns corresponding to the SWEBoK Areas
  mutate_all(replace_na,0) %>% 
  as.matrix() %>% 
  crossprod() %>% 
  kable() %>%
  kable_styling("striped", full_width = T) %>%
  column_spec(1, bold = T)
  
```

